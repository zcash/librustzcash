<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="Creates a transaction paying the specified address from the given account."><meta name="keywords" content="rust, rustlang, rust-lang, create_spend_to_address"><title>create_spend_to_address in zcash_client_backend::data_api::wallet - Rust</title><link rel="preload" as="font" type="font/woff2" crossorigin href="../../../SourceSerif4-Regular.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../../FiraSans-Regular.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../../FiraSans-Medium.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../../SourceCodePro-Regular.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../../SourceSerif4-Bold.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../../SourceCodePro-Semibold.ttf.woff2"><link rel="stylesheet" type="text/css" href="../../../normalize.css"><link rel="stylesheet" type="text/css" href="../../../rustdoc.css" id="mainThemeStyle"><link rel="stylesheet" type="text/css" href="../../../ayu.css" disabled><link rel="stylesheet" type="text/css" href="../../../dark.css" disabled><link rel="stylesheet" type="text/css" href="../../../light.css" id="themeStyle"><script id="default-settings" ></script><script src="../../../storage.js"></script><script src="../../../crates.js"></script><script defer src="../../../main.js"></script>
    <noscript><link rel="stylesheet" href="../../../noscript.css"></noscript><link rel="alternate icon" type="image/png" href="../../../favicon-16x16.png"><link rel="alternate icon" type="image/png" href="../../../favicon-32x32.png"><link rel="icon" type="image/svg+xml" href="../../../favicon.svg"></head><body class="rustdoc fn"><!--[if lte IE 11]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><nav class="mobile-topbar"><button class="sidebar-menu-toggle">&#9776;</button><a class="sidebar-logo" href="../../../zcash_client_backend/index.html"><div class="logo-container"><img class="rust-logo" src="../../../rust-logo.svg" alt="logo"></div>
        </a><h2 class="location"></h2>
    </nav>
    <nav class="sidebar"><a class="sidebar-logo" href="../../../zcash_client_backend/index.html"><div class="logo-container"><img class="rust-logo" src="../../../rust-logo.svg" alt="logo"></div>
        </a><div class="sidebar-elems"><h2 class="location"><a href="index.html">In zcash_client_backend::data_api::wallet</a></h2><div id="sidebar-vars" data-name="create_spend_to_address" data-ty="fn" data-relpath=""></div><script defer src="sidebar-items.js"></script></div></nav><main><div class="width-limiter"><div class="sub-container"><a class="sub-logo-container" href="../../../zcash_client_backend/index.html"><img class="rust-logo" src="../../../rust-logo.svg" alt="logo"></a><nav class="sub"><div class="theme-picker hidden"><button id="theme-picker" aria-label="Pick another theme!" aria-haspopup="menu" title="themes"><img width="22" height="22" alt="Pick another theme!" src="../../../brush.svg"></button><div id="theme-choices" role="menu"></div></div><form class="search-form"><div class="search-container"><span></span><input class="search-input" name="search" autocomplete="off" spellcheck="false" placeholder="Click or press ‘S’ to search, ‘?’ for more options…" type="search"><button type="button" id="help-button" title="help">?</button><a id="settings-menu" href="../../../settings.html" title="settings"><img width="22" height="22" alt="Change settings" src="../../../wheel.svg"></a></div></form></nav></div><section id="main-content" class="content"><div class="main-heading">
    <h1 class="fqn"><span class="in-band">Function <a href="../../index.html">zcash_client_backend</a>::<wbr><a href="../index.html">data_api</a>::<wbr><a href="index.html">wallet</a>::<wbr><a class="fn" href="#">create_spend_to_address</a><button id="copy-path" onclick="copy_path(this)" title="Copy item path to clipboard"><img src="../../../clipboard.svg" width="19" height="18" alt="Copy item path"></button></span></h1><span class="out-of-band"><a class="srclink" href="../../../src/zcash_client_backend/data_api/wallet.rs.html#168-208">source</a> · <a id="toggle-all-docs" href="javascript:void(0)" title="collapse all docs">[<span class="inner">&#x2212;</span>]</a></span></div><div class="docblock item-decl"><pre class="rust fn"><code>pub fn create_spend_to_address&lt;E, N, P, D, R&gt;(<br>&nbsp;&nbsp;&nbsp;&nbsp;wallet_db: <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.reference.html">&amp;mut </a>D, <br>&nbsp;&nbsp;&nbsp;&nbsp;params: <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.reference.html">&amp;</a>P, <br>&nbsp;&nbsp;&nbsp;&nbsp;prover: impl <a class="trait" href="../../../zcash_primitives/sapling/prover/trait.TxProver.html" title="trait zcash_primitives::sapling::prover::TxProver">TxProver</a>, <br>&nbsp;&nbsp;&nbsp;&nbsp;account: <a class="struct" href="../../../zcash_primitives/zip32/struct.AccountId.html" title="struct zcash_primitives::zip32::AccountId">AccountId</a>, <br>&nbsp;&nbsp;&nbsp;&nbsp;extsk: &amp;<a class="struct" href="../../keys/sapling/struct.ExtendedSpendingKey.html" title="struct zcash_client_backend::keys::sapling::ExtendedSpendingKey">ExtendedSpendingKey</a>, <br>&nbsp;&nbsp;&nbsp;&nbsp;to: &amp;<a class="enum" href="../../address/enum.RecipientAddress.html" title="enum zcash_client_backend::address::RecipientAddress">RecipientAddress</a>, <br>&nbsp;&nbsp;&nbsp;&nbsp;amount: <a class="struct" href="../../../zcash_primitives/transaction/components/amount/struct.Amount.html" title="struct zcash_primitives::transaction::components::amount::Amount">Amount</a>, <br>&nbsp;&nbsp;&nbsp;&nbsp;memo: <a class="enum" href="https://doc.rust-lang.org/nightly/core/option/enum.Option.html" title="enum core::option::Option">Option</a>&lt;<a class="struct" href="../../../zcash_primitives/memo/struct.MemoBytes.html" title="struct zcash_primitives::memo::MemoBytes">MemoBytes</a>&gt;, <br>&nbsp;&nbsp;&nbsp;&nbsp;ovk_policy: <a class="enum" href="../../wallet/enum.OvkPolicy.html" title="enum zcash_client_backend::wallet::OvkPolicy">OvkPolicy</a>, <br>&nbsp;&nbsp;&nbsp;&nbsp;min_confirmations: <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.u32.html">u32</a><br>) -&gt; <a class="enum" href="https://doc.rust-lang.org/nightly/core/result/enum.Result.html" title="enum core::result::Result">Result</a>&lt;R, E&gt; <span class="where fmt-newline">where<br>&nbsp;&nbsp;&nbsp;&nbsp;E: <a class="trait" href="https://doc.rust-lang.org/nightly/core/convert/trait.From.html" title="trait core::convert::From">From</a>&lt;<a class="enum" href="../error/enum.Error.html" title="enum zcash_client_backend::data_api::error::Error">Error</a>&lt;N&gt;&gt;,<br>&nbsp;&nbsp;&nbsp;&nbsp;P: <a class="trait" href="../../../zcash_primitives/consensus/trait.Parameters.html" title="trait zcash_primitives::consensus::Parameters">Parameters</a> + <a class="trait" href="https://doc.rust-lang.org/nightly/core/clone/trait.Clone.html" title="trait core::clone::Clone">Clone</a>,<br>&nbsp;&nbsp;&nbsp;&nbsp;R: <a class="trait" href="https://doc.rust-lang.org/nightly/core/marker/trait.Copy.html" title="trait core::marker::Copy">Copy</a> + <a class="trait" href="https://doc.rust-lang.org/nightly/core/fmt/trait.Debug.html" title="trait core::fmt::Debug">Debug</a>,<br>&nbsp;&nbsp;&nbsp;&nbsp;D: <a class="trait" href="../trait.WalletWrite.html" title="trait zcash_client_backend::data_api::WalletWrite">WalletWrite</a>&lt;Error = E, TxRef = R&gt;,&nbsp;</span></code></pre></div><details class="rustdoc-toggle top-doc" open><summary class="hideme"><span>Expand description</span></summary><div class="docblock"><p>Creates a transaction paying the specified address from the given account.</p>
<p>Returns the row index of the newly-created transaction in the <code>transactions</code> table
within the data database. The caller can read the raw transaction bytes from the <code>raw</code>
column in order to broadcast the transaction to the network.</p>
<p>Do not call this multiple times in parallel, or you will generate transactions that
double-spend the same notes.</p>
<h2 id="transaction-privacy"><a href="#transaction-privacy">Transaction privacy</a></h2>
<p><code>ovk_policy</code> specifies the desired policy for which outgoing viewing key should be
able to decrypt the outputs of this transaction. This is primarily relevant to
wallet recovery from backup; in particular, <a href="../../wallet/enum.OvkPolicy.html#variant.Discard" title="OvkPolicy::Discard"><code>OvkPolicy::Discard</code></a> will prevent the
recipient’s address, and the contents of <code>memo</code>, from ever being recovered from the
block chain. (The total value sent can always be inferred by the sender from the spent
notes and received change.)</p>
<p>Regardless of the specified policy, <code>create_spend_to_address</code> saves <code>to</code>, <code>value</code>, and
<code>memo</code> in <code>db_data</code>. This can be deleted independently of <code>ovk_policy</code>.</p>
<p>For details on what transaction information is visible to the holder of a full or
outgoing viewing key, refer to <a href="https://zips.z.cash/zip-0310">ZIP 310</a>.</p>
<p>Parameters:</p>
<ul>
<li><code>wallet_db</code>: A read/write reference to the wallet database</li>
<li><code>params</code>: Consensus parameters</li>
<li><code>prover</code>: The TxProver to use in constructing the shielded transaction.</li>
<li><code>account</code>: The ZIP32 account identifier associated with the extended spending
key that controls the funds to be used in creating this transaction.  This
procedure will return an error if this does not correctly correspond to <code>extsk</code>.</li>
<li><code>extsk</code>: The extended spending key that controls the funds that will be spent
in the resulting transaction.</li>
<li><code>amount</code>: The amount to send.</li>
<li><code>to</code>: The address to which <code>amount</code> will be paid.</li>
<li><code>memo</code>: A memo to be included in the output to the recipient.</li>
<li><code>ovk_policy</code>: The policy to use for constructing outgoing viewing keys that
can allow the sender to view the resulting notes on the blockchain.</li>
<li><code>min_confirmations</code>: The minimum number of confirmations that a previously
received note must have in the blockchain in order to be considered for being
spent. A value of 10 confirmations is recommended.</li>
</ul>
<h2 id="examples"><a href="#examples">Examples</a></h2>
<div class="example-wrap"><pre class="rust rust-example-rendered"><code><span class="kw">use</span> <span class="ident">tempfile::NamedTempFile</span>;
<span class="kw">use</span> <span class="ident">zcash_primitives</span>::{
    <span class="ident">consensus</span>::{<span class="self">self</span>, <span class="ident">Network</span>},
    <span class="ident">constants::testnet::COIN_TYPE</span>,
    <span class="ident">transaction</span>::{<span class="ident">TxId</span>, <span class="ident">components::Amount</span>},
    <span class="ident">zip32::AccountId</span>,
};
<span class="kw">use</span> <span class="ident">zcash_proofs::prover::LocalTxProver</span>;
<span class="kw">use</span> <span class="ident">zcash_client_backend</span>::{
    <span class="ident">keys::sapling</span>,
    <span class="ident">data_api</span>::{<span class="ident">wallet::create_spend_to_address</span>, <span class="ident">error::Error</span>, <span class="ident">testing</span>},
    <span class="ident">wallet::OvkPolicy</span>,
};


<span class="kw">let</span> <span class="ident">tx_prover</span> <span class="op">=</span> <span class="kw">match</span> <span class="ident">LocalTxProver::with_default_location</span>() {
    <span class="prelude-val">Some</span>(<span class="ident">tx_prover</span>) =&gt; <span class="ident">tx_prover</span>,
    <span class="prelude-val">None</span> =&gt; {
        <span class="macro">panic!</span>(<span class="string">&quot;Cannot locate the Zcash parameters. Please run zcash-fetch-params or fetch-params.sh to download the parameters, and then re-run the tests.&quot;</span>);
    }
};

<span class="kw">let</span> <span class="ident">account</span> <span class="op">=</span> <span class="ident">AccountId::from</span>(<span class="number">0</span>);
<span class="kw">let</span> <span class="ident">extsk</span> <span class="op">=</span> <span class="ident">sapling::spending_key</span>(<span class="kw-2">&amp;</span>[<span class="number">0</span>; <span class="number">32</span>][..], <span class="ident">COIN_TYPE</span>, <span class="ident">account</span>);
<span class="kw">let</span> <span class="ident">to</span> <span class="op">=</span> <span class="ident">extsk</span>.<span class="ident">default_address</span>().<span class="number">1</span>.<span class="ident">into</span>();

<span class="kw">let</span> <span class="kw-2">mut</span> <span class="ident">db_read</span> <span class="op">=</span> <span class="ident">testing::MockWalletDb</span> {};

<span class="ident">create_spend_to_address</span>(
    <span class="kw-2">&amp;mut</span> <span class="ident">db_read</span>,
    <span class="kw-2">&amp;</span><span class="ident">Network::TestNetwork</span>,
    <span class="ident">tx_prover</span>,
    <span class="ident">account</span>,
    <span class="kw-2">&amp;</span><span class="ident">extsk</span>,
    <span class="kw-2">&amp;</span><span class="ident">to</span>,
    <span class="ident">Amount::from_u64</span>(<span class="number">1</span>).<span class="ident">unwrap</span>(),
    <span class="prelude-val">None</span>,
    <span class="ident">OvkPolicy::Sender</span>,
    <span class="number">10</span>
)
</code></pre></div>
</div></details></section><section id="search" class="content hidden"></section></div></main><div id="rustdoc-vars" data-root-path="../../../" data-current-crate="zcash_client_backend" data-themes="ayu,dark,light" data-resource-suffix="" data-rustdoc-version="1.62.0-nightly (18f314e70 2022-04-24)" ></div>
</body></html>